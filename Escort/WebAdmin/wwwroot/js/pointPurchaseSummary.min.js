function LoadTable(){if(toastr.remove(),$("#txtFromDate").val()==""&&$("#txtToDate").val()=="")return toastr.error('"Please provide either a From Date or a To Date."'),!1;const n=new Date($("#txtFromDate").val()),t=new Date($("#txtToDate").val());if(n>t)return toastr.error("From date can not be greater than to date."),!1;clientSpendingReport.List()}function Reset(){$("#txtFromDate").val("");$("#txtToDate").val("");clientSpendingReport.List()}$(function(){$.when(clientSpendingReport.ResetStateSaveDataTable()).then(function(){clientSpendingReport.List()})});let userstable=$("#data-table_userTransaction"),clientSpendingReport={ResetStateSaveDataTable:function(){common.isReferrer()&&userstable.DataTable().state.clear()},List:function(){let t=[];$(userstable).find("thead tr th").each(function(n,i){let r=$(i).data("name"),u;switch(r.toLowerCase()){case"id":u={data:null,name:r,render:function(n,t,i,r){return r.row+r.settings._iDisplayStart+1}};break;case"pointpurchased":u={width:"25%","class":"dt-right",data:null,name:r,render:function(n){return n.pointsPurchased}};break;case"pointspurchased":u={width:"25%","class":"dt-right rpad-26",data:null,name:r,render:function(n){return n.pointsPurchased}};break;case"pointsbalance":u={width:"25%","class":"dt-right rpad-26",data:null,name:r,render:function(n){return n.pointsBalance}};break;case"pointsspent":u={width:"25%","class":"dt-right rpad-26",data:null,name:r,render:function(n){return n.pointsSpent}};break;case"amount":u={width:"25%","class":"dt-right rpad-26",data:null,name:r,render:function(n){return"$"+n.amount.toFixed(2).toLocaleString("en")}};break;case"date":u={data:null,name:r,width:"15%",maxWidth:"15%",render:function(n,t){if(t==="display"||t==="filter"){const t=new Date(n.date),i=("0"+t.getDate()).slice(-2),r=("0"+(t.getMonth()+1)).slice(-2),u=t.getFullYear();return i+"/"+r+"/"+u}return n}};break;default:u={data:r.charAt(0).toLowerCase()+r.slice(1),name:r}}t.push(u)});let i,n=$("#filterBy").val(),r=$("#currentId").val();i=n==1?[0,2]:n==2?[0]:[0];let u={UserId:r,FromDate:$("#txtFromDate").val(),ToDate:$("#txtToDate").val(),FilterBy:n};tbl.BindTable(userstable,`/UserTokenTransaction/GetListByName`,u,t,i);setTimeout(function(){clientSpendingReport.SumOfPoints(n)},1e3)},SumOfPoints:function(n){let f=userstable.DataTable(),t=0,i=0,u=0,r=0;f.rows().every(function(){n==1?(t=parseInt(t)+parseInt(this.data().pointsPurchased),r=r+this.data().amount):n==2?i=parseInt(i)+parseInt(this.data().pointsSpent):(t=parseInt(t)+parseInt(this.data().pointsPurchased),i=parseInt(i)+parseInt(this.data().pointsSpent),u=parseInt(u)+parseInt(this.data().pointsBalance))});n==1?($("#total_purchase").text(t),$("#total_amount").text("$"+Number(r).toFixed(2).toLocaleString("en"))):n==2?$("#total_spent_2").text(i):($("#total_purchase").text(t),$("#total_spent").text(i),$("#total_balance").text(t-i))}};$("#txtFromDate").datepicker({weekStart:1,autoclose:!0,todayHighlight:!1,dateFormat:"dd-M-yy",changeMonth:!0,changeYear:!0,maxDate:-1,onSelect:function(n){const t=new Date(n);$("#txtToDate").datepicker("option","minDate",t)}});$("#txtToDate").datepicker({weekStart:1,autoclose:!0,todayHighlight:!1,dateFormat:"dd-M-yy",changeMonth:!0,changeYear:!0,maxDate:0,onSelect:function(n){const t=new Date(n);$("#txtFromDate").datepicker("option","maxDate",t)}});